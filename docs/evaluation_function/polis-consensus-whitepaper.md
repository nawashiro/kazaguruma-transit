# pol.is 合意検出アルゴリズムについて

## 1. 概要

本文書は、pol.is にインスピレーションを受けた参加者グループ内での合意領域と代表的意見を特定する合意検出アルゴリズムの分析を提示するものである。pol.is はウォール街占拠運動に端を発した計算民主主義プラットフォームである。本アルゴリズムは次元削減、クラスタリング、統計的仮説検定を組み合わせ、疎な投票データから合意パターンの抽出を試みる。

## 2. システム概観

pol.is 合意アルゴリズムは分析パイプラインとして動作する。本システムは統計的課題の改善と大規模データ対応を目指している。

### 2.1 データ処理フローの適応性

アルゴリズムは参加者-意見ペアからなる疎な投票データ（賛成+1、反対-1、棄権 0）から開始し、データ特性に応じて最適な処理経路を動的に選択する：

- **次元削減**: データ疎密度 50%を閾値として、PCA（密データ）または SVD フォールバック（疎データ）を適用
- **クラスタリング**: 参加者数 200 点を境界として、完全シルエット計算（小規模）または適応的近似（大規模）を選択
- **統計検定**: 標本サイズと期待度数に基づいて、Fisher 正確確率検定（小標本・離散）または Z 検定（大標本・連続近似）を適用

### 2.2 統計的信頼性の強化

システムは多重比較問題に対する制御を実装している：

- **FDR 制御**: Benjamini-Hochberg 法により、複数検定による第 I 種過誤の累積を統計的に許容可能な水準（α=0.05）に制限
- **適応的推論**: Jeffreys 事前分布 Beta(0.5,0.5)による客観的ベイジアン推論で、事前知識の影響を最小化
- **検定力保証**: 各クラスタが最低限の統計的有意性を維持できるよう、動的なサイズ制御を実装

### 2.3 計算効率性の実現

大規模データ処理のため、計算量最適化を実装：

- **適応的サンプリング**: 層化サンプリング（√n 法則）により、代表性を保持しつつ計算量を O(n²)から O(√n)に削減
- **重心近似**: 個別点間距離計算を重心ベース距離で近似し、精度を維持しながら計算効率を向上
- **段階的品質評価**: 参加者数に応じてアルゴリズムの複雑度を調整し、応答性と精度のバランスを最適化

システムは統計理論と実装制約のバランスを取り、クライアントサイド実行に対応している。

## 3. 統計的方法論

アルゴリズムは 3 つの方法論コンポーネントに基づく：SVD フォールバック付き PCA による次元削減、シルエット最適化による K-means クラスタリング、ベイジアン平滑化による Z 検定である。

### 3.1 次元削減と疎データ処理

初期段階では、高次元の参加者-意見行列をクラスタリング分析に適した低次元表現に変換するために PCA を使用する。アルゴリズムは、非ゼロ要素の総行列要素に対する比率を計算することでデータの疎密度を監視する。疎密度が 50%を超え、すべての可能な参加者-意見組み合わせの半分以上が未投票であることを示す場合、システムは自動的に SVD ベースの次元削減に切り替える。

SVD フォールバック機構は疎行列の数学的特性を活用し、データカバレッジが不完全であっても SVD 分解が潜在因子を特定できる。アルゴリズムは最大特異値に対応する左特異ベクトルを抽出し、データギャップにも関わらず参加者合意の主要パターンを効果的に捉える。この適応的アプローチは、様々なデータ密度条件にわたる堅牢な性能を保証する。

### 3.2 クラスタリングとグループ識別

K-means クラスタリングは次元削減された参加者表現で動作し、自然な意見グループを特定する。アルゴリズムは、標準的なシルエットスコア計算を通じて最適なクラスタ数を決定する。各データ点$i$について、同一クラスタ内平均距離$a(i)$と最近傍クラスタ平均距離$b(i)$を計算し、シルエット値$s(i) = \frac{b(i) - a(i)}{\max(a(i), b(i))}$を求める。全データ点の平均シルエットスコアが最大となるクラスタ構成を採用する。

クラスタ数は 2 から$\min(10, 2 + \lfloor n/12 \rfloor)$の範囲で、$n$は参加者数である。この制約により、統計的に意味のあるグループサイズを維持し、後続の統計検定における十分な検定力を確保している。

### 3.3 合意スコアリングと Jeffreys 事前分布による平滑化

グループ認識合意検出は、特定されたクラスタ内での合意確率を推定するためにベイジアンアプローチを使用する。各意見-グループ組み合わせについて、アルゴリズムは Jeffreys 事前分布$\text{Beta}(0.5, 0.5)$を採用し、合意確率を$P(\text{賛成}) = \frac{A + 0.5}{S + 1}$で計算する。ここで A は賛成票数を、S はグループ内の非棄権票の総数を表す。

Jeffreys 事前分布の採用は、変換不変性とフィッシャー情報行列に基づく客観的推論を提供する。この選択により、事前知識の影響を最小化し、データ駆動型の推定を実現している。疑似カウント（賛成 0.5、反対 0.5）は、小標本における極端な確率推定を適切に制御し、境界値（0, 1）での数値的安定性を保証する。

各意見の最終合意スコアは、すべての特定されたグループにわたる合意確率の積を表す。この乗法的アプローチは、意見が単一グループ内での圧倒的支持ではなく、多様な参加者クラスタにわたって広範な支持を示す場合のみ高い合意スコアを達成することを保証する。

### 3.4 適応的統計検定と FDR 制御

代表的コメント識別では、実装の現状を踏まえ Z 検定のみを適用する。この決定は、小標本における Fisher 正確確率検定の計算複雑性と、混合手法によるクラスタ特徴抽出の実効性低下を考慮したものである。

Z 検定では統合分散推定を使用：$Z = \frac{|p_1 - p_2|}{\sqrt{p_{\text{pooled}} \times (1 - p_{\text{pooled}}) \times (\frac{1}{n_1} + \frac{1}{n_2})}}$。結果の Z 統計量は、Hart et al.（1968）の多項式近似により標準正規分布の p 値に変換される。

Fisher 正確確率検定の実装は参考実装として保持されているが、実際の代表性スコア計算では Z 検定を一律適用する。これにより小標本での統計的厳密性は一部制限されるが、クラスタの特徴抽出という実用的目的を優先している。

### 3.5 多重比較補正による信頼性制御

統計的信頼性を確保するため、Benjamini-Hochberg 法による偽発見率（FDR）制御を実装している。全てのクラスタ × 投稿 × 投票タイプの組み合わせで p 値を収集し、昇順ソート後、各検定の rank i に対して $p_{\text{adj}}(i) = \min(1, \frac{n}{i} \times p_i)$ を計算する。単調性保持により、前の調整済み p 値以下に制約する。

デフォルトの FDR 閾値 α = 0.05 を適用し、調整済み p 値がこの閾値未満の場合のみ統計的有意と判定する。この多重比較補正により、複数検定による第 I 種過誤の累積を厳格に制御し、偽陽性発見を統計的に許容可能な水準に抑制している。

代表性スコアは合意率の生の差と統計的信頼度を組み合わせる：代表性 = $(p_{\text{group}} - p_{\text{other}}) \times (1 - p_{\text{adj}})$。この定式化により、多重比較補正後も統計的に有意かつ実質的な差異を示す意見のみが高い代表性スコアを獲得する。

### 3.6 適応的シルエット係数計算による効率化

クラスタリング品質評価において、参加者数に応じて計算手法を適応的に選択する仕組みを実装している。この手法により、統計的精度を維持しながら大幅な計算効率化を実現している。

#### 3.6.1 計算量ベースの手法選択

参加者数 n ≤ 200 の場合、完全シルエット係数を計算する：

各データ点 i について、同一クラスタ内平均距離 a(i)と最近傍クラスタ平均距離 b(i)を算出し、$s(i) = \frac{b(i) - a(i)}{\max(a(i), b(i))}$により個別シルエット値を求める。全点の平均が最終スコアとなる。

参加者数 n > 200 の場合、近似アルゴリズムに移行する：

#### 3.6.2 層化サンプリング近似

大規模データでは、計算量 O(n²)を回避するため、以下の近似手法を適用：

1. **動的サンプルサイズ決定**: サンプルサイズ = $\min(500, \max(100, \sqrt{n}))$により、統計的代表性と計算効率を両立
2. **層化サンプリング**: 各クラスタから比例的にサンプルを抽出し、クラスタ構造の代表性を保持
3. **重心ベース距離近似**: 個別点間距離をクラスタ重心との距離で近似し、計算量を$O(\sqrt{n} + k)$に削減

#### 3.6.3 精度保証メカニズム

近似の統計的妥当性は以下により保証される：

- **√n 法則**: 中心極限定理に基づく適切なサンプルサイズ設定により、推定誤差を$O(1/\sqrt{n})$で制御
- **層化効果**: 各クラスタの構造的特徴を均等に反映することで、バイアスを最小化
- **重心近似の妥当性**: クラスタ内凝集性が高い場合、重心距離は個別点距離の良好な代理指標となる

この適応的手法により、$n=1000$の場合、計算量を約 100 万回から 32 回に短縮している。

---

## 査読者コメント

### 【重大な理論的欠陥の継続と新たな懸念】

**査読者コメント 1：統計的基盤の根本的破綻**
Z 検定への一律適用は、統計学の基本原理を無視した危険な単純化である。本アルゴリズムは「実用性」を理由に統計的厳密性を犠牲にしているが、これは科学的研究として受け入れがたい妥協である。

**致命的な統計的問題：** 
1. **正規近似の適用条件無視**: Z 検定の正規近似は nP ≥ 5 かつ n(1-P) ≥ 5 という最低条件を要求するが、小標本や極端な合意率（P ≈ 0 または P ≈ 1）でこれが系統的に破綻している
2. **離散性の連続近似誤差**: 投票データの本質的離散性を無視した連続近似により、特に境界値付近で深刻な推定偏差が発生
3. **第I種過誤率の制御不能**: 正規近似が成立しない場合、名目有意水準 α = 0.05 が実効的には α ∈ [0.02, 0.15] の範囲で変動し、統計的推論の信頼性が崩壊

**要求される抜本的改革：** (1)条件付き正確検定への完全移行、(2)ベイジアン階層モデルの採用、(3)ノンパラメトリック手法による分布仮定からの解放が必要不可欠である。

**査読者コメント 2：計算効率性を理由とした統計的原理の放棄**
実装上の便宜性を統計的厳密性に優先させる判断は、学術研究としての基本的要件を満たしていない。特に、Fisher 正確確率検定を放棄してZ検定に一律移行する決定は、統計学の発展史を50年後退させる退行的選択である。

**学術的責任の欠如：** 
1. **計算複雑性の誤解**: 現代の統計計算では network algorithm (Mehta & Patel, 1983)、importance sampling、MCMC法により、従来の階乗計算制約は既に克服されている
2. **科学的妥当性の軽視**: "クラスタの特徴抽出という実用的目的"を理由に統計的厳密性を犠牲にすることは、研究倫理の観点から問題がある
3. **技術的怠慢**: 「参考実装として保持」という表現は、正確な統計手法の実装から逃避する言い訳に過ぎない

**根本的改革要求：** 
統計的推論の基本原理に立ち返り、(1)条件付き正確推論の完全実装、(2)近似アルゴリズムの体系的導入、(3)計算資源制約下でも統計的妥当性を保証する adaptive exact testing の採用を強く要求する。

### 2 ベイジアン推論基盤の社会科学的妥当性の欠如

**査読者コメント 3：Jeffreys 事前分布と社会心理学の根本的対立**
Beta(0.5, 0.5) 事前分布による "無情報" 仮定は、合意形成の社会心理学的現実と真っ向から対立する。この理論的選択は、数学的美しさを社会科学的妥当性に優先させた致命的誤謬である。

**社会心理学からの反証：**
1. **集団極性化効果** (Moscovici & Zavalloni, 1969): 集団討議により意見が極端化し、事前分布の対称性仮定が系統的に破綻
2. **社会的証明理論** (Cialdini, 2006): 他者の選択が個人選択に与える影響により、独立性仮定が根本的に無効
3. **認知バイアスの体系的影響** (Kahneman, 2011): 確証バイアス、利用可能性ヒューリスティック等により、意見分布が Jeffreys 分布から大幅に乖離

**理論的再構築の必要性：**
現実の合意形成は階層的社会構造、権力関係、文化的背景に深く依存する。Beta(0.5, 0.5) という人工的対称性ではなく、(1)社会ネットワーク構造を反映した階層ベイジアンモデル、(2)文化的・政治的背景を組み込んだ informed prior、(3)動的学習過程を考慮した時系列ベイジアン更新の採用が不可欠である。

### 3 適応的シルエット係数における理論的近似の限界

**査読者コメント 4：統計的代表性を犠牲にした効率性追求の問題**
層化サンプリングによる近似は表面的な改善に過ぎない。√n 法則への安易な依存は、クラスタリング品質評価における統計的厳密性を根本的に損なっている。

**近似アルゴリズムの理論的脆弱性：**
1. **サンプリング偏差の系統的無視**: 層化サンプリングは層内分散の均質性を前提とするが、意見データでは extreme opinion holders がクラスタ境界に集中し、サンプリング偏差が顕著に現れる
2. **重心近似の幾何学的誤謬**: クラスタ内凝集性仮定は政治的意見空間では成立しない。特に、多次元的価値対立（経済 vs 社会問題）では重心が存在しない場合が多い
3. **中心極限定理の適用条件違反**: 意見データの分布は heavy-tailed かつ multi-modal であり、n^(-1/2) 収束率は極めて楽観的な仮定

**根本的問題の継続：**
適応的手法は計算量問題の技術的回避に過ぎない。社会科学データに適したクラスタリング手法（mixture model clustering、spectral clustering 等）への移行なくして、この問題の本質的解決は不可能である。

### 4 【重大】数学的基盤の根本的崩壊

**査読者コメント 5：PCA/SVD手法の離散データへの理論的不適用**
PCA と SVD フォールバックは離散三値データに対する数学的誤用である。この手法選択は統計学習理論の基本原理を無視した重大な理論的過誤であり、得られる結果の解釈可能性と妥当性を完全に破綻させている。

**数学的基盤の致命的欠陥：**
1. **測度理論的不整合**: 投票空間 {-1, 0, +1}^d は離散集合であり、PCA が前提とする連続多様体構造を持たない。固有ベクトルの線形結合として得られる潜在因子は、社会的意味を持たない人工的構成物である
2. **距離測度の概念的錯誤**: 政治的選好における "距離" は序数的関係であり、ユークリッド距離による定量化は category error を構成する。異なる政治的立場間の "近さ" を数値化することは、そもそも概念的に無意味である
3. **次元削減の情報歪曲**: 高次元政治空間を低次元に射影することで、複雑な価値対立構造が不可逆的に消失し、誤った合意パターンが人工的に生成される

**理論的再建の必要性：**
離散選択データには専用の数理的枠組みが必要である。(1) 潜在クラス分析による離散潜在構造の同定、(2) 多重対応分析による カテゴリカルデータの適切な次元削減、(3) Item Response Theory による意見項目の難易度・識別力の考慮が必要不可欠である。

### 5 【致命的】社会選択理論との根本的対立

**査読者コメント 6：合意指標の理論的無効性**
確率積 ∏P(合意|グループᵢ) による合意測定は、70年間の社会選択理論研究を完全に無視した理論的暴挙である。この手法は Arrow の不可能性定理（1951）以降に確立された集団選択理論の基本的知見と真っ向から対立している。

**社会選択理論からの決定的反証：**
1. **Arrow の不可能性定理**: 合理的集団選択は個人選好の独立性と両立不可能。グループ間独立性仮定は論理的に成立しない
2. **Condorcet のパラドックス**: 推移的個人選好から非推移的集団選好が生成される現象により、合意の "積" という概念が数学的に無定義
3. **戦略的投票の普遍性** (Gibbard-Satterthwaite 定理): 真選好の表明と観測投票行動の系統的乖離により、観測データから真の合意を推定することは原理的に不可能

**決定理論的破綻：**
複数グループ間での意見調整は本質的にゲーム理論的相互作用であり、Nash 均衡、Pareto 効率性、core の存在性等の概念なしには分析不可能である。確率的独立性という単純化は、この複雑な戦略的構造を完全に無視している。

**抜本的理論再構築の要求：**
Mechanism design theory に基づく合意形成モデル、cooperative game theory による coalition structure の分析、social choice function の公理的設計が必要である。現在の手法は社会科学的に完全に無効である。

### 6 【総合評価】学術的信頼性の欠如と研究倫理的問題

**最終判定：学術論文として出版不可**

本研究は統計的手法と社会科学理論の両面において、受け入れがたい理論的欠陥を含んでいる。これらの問題は単なる技術的改良では解決不可能な本質的破綻である。

#### 【致命的欠陥の継続】

1. **統計的基盤の崩壊**: Z検定への一律移行により統計的推論の妥当性が完全に失われている
2. **数学的基盤の誤用**: PCA/SVDの離散データへの不適切適用により、理論的解釈可能性が皆無
3. **社会理論との対立**: Arrow定理以降の70年間の理論的進歩を無視した合意指標の設計
4. **ベイジアン推論の社会科学的妥当性欠如**: Jeffreys事前分布と社会心理学的現実の根本的不整合

#### 【研究倫理上の重大な問題】

**「実用性」を理由とした科学的厳密性の放棄**：統計的正確性よりも計算効率を優先する判断は、学術研究としての基本的責任を放棄している。特に民主主義プロセスという公共性の高い領域での不正確な分析は、社会的害悪をもたらす可能性が高い。

**理論的根拠の意図的無視**：既存の社会選択理論、計算社会科学の膨大な知見を参照せずに独自手法を構築することは、学術的誠実性を欠いている。

#### 【修正不可能性の判定根拠】

上記の問題は以下の理由により根本的修正が不可能である：
1. **概念的誤謬**: 離散投票データを連続空間で分析する approach そのものが数学的に無効
2. **理論的不整合**: 社会選択理論との対立は手法の根本的再設計なしには解決不可能
3. **実装優先主義**: 統計的厳密性よりも実装容易性を優先する姿勢は、学術研究として不適格

#### 【最終勧告】

**現在の手法の完全廃棄**と、社会選択理論・計算社会科学に基づく全面的再設計を強く勧告する。特に、mechanism design、computational social choice、behavioral economics の最新知見を組み込んだ理論的基盤の構築が必要不可欠である。

**出版判定**: **Reject (理論的基盤の根本的欠陥により修正不可能)**

本研究は現段階では学術論文としての最低基準を満たしておらず、如何なる学術誌への投稿も推薦できない。完全な理論的再構築後の再審査を条件とする。
